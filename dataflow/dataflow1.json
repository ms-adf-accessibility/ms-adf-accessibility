{
	"name": "dataflow1",
	"properties": {
		"sources": [
			{
				"dataset": {
					"referenceName": "TaxiTripData",
					"type": "DatasetReference"
				},
				"name": "TaxiTripData",
				"script": "source(output(medallion as date 'MM/dd/yyyy',hack_license as string,vendor_id as string,rate_code as string,store_and_fwd_flag as string,pickup_datetime as string,dropoff_datetime as string,passenger_count as string,trip_time_in_secs as string,trip_distance as string,pickup_longitude as string,pickup_latitude as string,dropoff_longitude as string,dropoff_latitude as string),allowSchemaDrift: true,validateSchema: false) ~> TaxiTripData"
			},
			{
				"dataset": {
					"referenceName": "TaxiFareData",
					"type": "DatasetReference"
				},
				"name": "TaxiFareData",
				"script": "source(output(medallion as string,{ hack_license} as string,{ vendor_id} as string,{ pickup_datetime} as string,{ payment_type} as string,{ fare_amount} as string,{ surcharge} as string,{ mta_tax} as string,{ tip_amount} as string,{ tolls_amount} as string,{ total_amount} as string),allowSchemaDrift: true,validateSchema: false) ~> TaxiFareData"
			}
		],
		"sinks": [
			{
				"dataset": {
					"referenceName": "Output",
					"type": "DatasetReference"
				},
				"name": "sink1",
				"script": "DerivedColumn2 sink(saveMode:'overwrite' , mapColumn(medallion,hack_license,vendor_id,rate_code,store_and_fwd_flag,pickup_datetime,dropoff_datetime,passenger_count,trip_time_in_secs,trip_distance,pickup_longitude,pickup_latitude,dropoff_longitude,dropoff_latitude,vendor_id2)) ~> sink1"
			}
		],
		"transformations": [
			{
				"name": "DerivedColumn1",
				"script": "TaxiTripData derive(vendor_id = null()) ~> DerivedColumn1"
			},
			{
				"name": "DerivedColumn2",
				"script": "DerivedColumn1 derive(vendor_id2 = null()) ~> DerivedColumn2"
			}
		]
	}
}